<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.fly.client.stats.dao.StatsDao">

<select id= "stadiumstats" resultType="clientstats" parameterType="String" >
	SELECT
		count(r.r_no)as count, s.s_name , to_char(r_reserve_date, 'yyyy/MM') 
	FROM rental r, stadium s
	WHERE
		<![CDATA[r_reserve_date <= SYSDATE]]> and r.s_no = s.s_no and r_pay_status = 1 
		and s.s_no in(select s_no from STADIUM where p_num = '0109973329112')
	GROUP BY s_name, to_char(r_reserve_date, ' yyyy/MM')
</select>
	
</mapper>